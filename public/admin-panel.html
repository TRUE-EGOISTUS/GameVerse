```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <!-- Main Styles -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="loading">
  <header>
    <div class="header-content">
      <h1 class="neon-text">üëë –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
      <nav class="nav-links">
        <a href="index.html" class="btn">‚Üê –ù–∞–∑–∞–¥</a>
      </nav>
    </div>
  </header>
  <main class="main-container">
    <section class="filter-section">
      <div class="filter-panel">
        <h2 class="section-title">–§–∏–ª—å—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
        <div class="genre-buttons">
          <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" aria-label="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π" />
          <select id="roleFilter" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏">
            <option value="">–í—Å–µ —Ä–æ–ª–∏</option>
            <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
            <option value="developer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
          </select>
          <select id="statusFilter" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option value="online">–í —Å–µ—Ç–∏</option>
            <option value="offline">–ù–µ –≤ —Å–µ—Ç–∏</option>
          </select>
          <button id="refreshBtn" class="btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
      </div>
    </section>

    <section class="games-section">
      <div id="loader" class="loading"></div>
      <div id="errorMsg" class="errorMsg"></div>
      <div id="successMsg" class="successMsg"></div>
      <div class="games-grid user-list" id="userList" aria-live="polite"></div>
    </section>
  </main>

  <!-- Moderation Modal -->
  <div id="moderationModal" class="modal">
    <div class="modal-content">
      <h3>–ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <span id="modUserName"></span></h3>
      <div class="input-group">
        <label for="actionSelect">–î–µ–π—Å—Ç–≤–∏–µ:</label>
        <select id="actionSelect">
          <option value="ban">–ó–∞–±–∞–Ω–∏—Ç—å</option>
          <option value="suspend">–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</option>
          <option value="change_role">–ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å</option>
          <option value="delete">–£–¥–∞–ª–∏—Ç—å</option>
        </select>
      </div>
      <div class="input-group" id="roleGroup" style="display:none;">
        <label for="newRoleSelect">–ù–æ–≤–∞—è —Ä–æ–ª—å:</label>
        <select id="newRoleSelect">
          <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
          <option value="developer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
          <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
        </select>
      </div>
      <div class="game-buttons admin-buttons">
        <button id="confirmModeration" class="rate-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <button id="cancelModeration" class="btn">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <script>
    let usersData = [];
    let modUser = null;
    const loader = document.getElementById('loader');
    const errorMsg = document.getElementById('errorMsg');
    const successMsg = document.getElementById('successMsg');
    const searchInput = document.getElementById('searchInput');
    const roleFilter = document.getElementById('roleFilter');
    const statusFilter = document.getElementById('statusFilter');
    const refreshBtn = document.getElementById('refreshBtn');
    const userList = document.getElementById('userList');
    const modal = document.getElementById('moderationModal');
    const modUserName = document.getElementById('modUserName');
    const actionSelect = document.getElementById('actionSelect');
    const roleGroup = document.getElementById('roleGroup');
    const newRoleSelect = document.getElementById('newRoleSelect');
    const confirmBtn = document.getElementById('confirmModeration');
    const cancelBtn = document.getElementById('cancelModeration');

    function setLoading(active) {
      document.body.classList.toggle('loading', active);
      loader.style.display = active ? 'block' : 'none';
    }

    function showError(message) {
      errorMsg.textContent = message;
      errorMsg.style.display = 'block';
      successMsg.style.display = 'none';
      setTimeout(() => {
        errorMsg.style.display = 'none';
      }, 5000);
    }

    function showSuccess(message) {
      successMsg.textContent = message;
      successMsg.style.display = 'block';
      errorMsg.style.display = 'none';
      setTimeout(() => {
        successMsg.style.display = 'none';
      }, 5000);
    }

    function applyFilters() {
      const q = searchInput.value.toLowerCase();
      const r = roleFilter.value;
      const s = statusFilter.value;
      const filtered = usersData.filter(u => (
        (!r || u.role === r) &&
        (!s || (s === 'online' ? u.online : !u.online)) &&
        u.username.toLowerCase().includes(q)
      ));
      renderUsers(filtered);
    }

    function renderUsers(list) {
      userList.innerHTML = list.map(u => `
        <div class="user-card" tabindex="0">
          <div class="user-info-header">
            <span class="user-name">üë§ <strong>${u.username}</strong></span>
            <span class="user-status ${u.online ? 'status-online' : 'status-offline'}">${u.online ? 'üü¢' : 'üî¥'}</span>
          </div>
          <div class="user-role-badge role-${u.role}">${u.role === 'admin' ? 'üëë –ê–¥–º–∏–Ω' : u.role === 'developer' ? 'üíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫' : 'üéÆ –ò–≥—Ä–æ–∫'}</div>
          <div class="user-status-info">
            ${u.banned ? '<span class="status-banned">üö´ –ó–∞–±–∞–Ω–µ–Ω</span>' : ''}
            ${u.suspendedUntil && new Date(u.suspendedUntil) > new Date() ? `<span class="status-suspended">‚è∏ –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–æ ${new Date(u.suspendedUntil).toLocaleDateString()}</span>` : ''}
          </div>
          <div class="admin-buttons">
            <button class="rate-btn" onclick="openModeration('${u.username}')">–ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
        </div>
      `).join('');
    }

    async function fetchUsers() {
      setLoading(true);
      errorMsg.textContent = '';
      successMsg.textContent = '';
      try {
        const token = localStorage.getItem('token');
        if (!token) throw new Error('–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
        const res = await fetch('/admin/users', { headers: { 'Authorization': `Bearer ${token}` } });
        if (res.status === 403) throw new Error('–ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞');
        if (!res.ok) {
          const error = await res.json();
          throw new Error(error.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        }
        usersData = await res.json();
        applyFilters();
      } catch (e) {
        showError(e.message);
      } finally {
        setLoading(false);
      }
    }

    function openModeration(username) {
      modUser = username;
      modUserName.textContent = username;
      actionSelect.value = 'ban';
      roleGroup.style.display = 'none';
      modal.classList.add('active');
    }

    actionSelect.addEventListener('change', () => {
      roleGroup.style.display = actionSelect.value === 'change_role' ? 'block' : 'none';
    });

    async function applyModeration() {
      const action = actionSelect.value;
      const token = localStorage.getItem('token');
      let url = `/admin/users/${modUser}`;
      let opts = { 
        headers: { 
          'Authorization': `Bearer ${token}`, 
          'Content-Type': 'application/json' 
        } 
      };
      let successMessage = '';
      try {
        switch(action) {
          case 'ban':
            opts.method = 'POST'; 
            url += '/ban'; 
            successMessage = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${modUser} –∑–∞–±–∞–Ω–µ–Ω`;
            break;
          case 'suspend':
            opts.method = 'POST'; 
            url += '/suspend'; 
            successMessage = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${modUser} –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 7 –¥–Ω–µ–π`;
            break;
          case 'change_role':
            opts.method = 'PUT'; 
            url += '/role'; 
            opts.body = JSON.stringify({ role: newRoleSelect.value }); 
            successMessage = `–†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${modUser} –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ ${newRoleSelect.value}`;
            break;
          case 'delete':
            opts.method = 'DELETE'; 
            successMessage = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${modUser} —É–¥–∞–ª—ë–Ω`;
            break;
        }
        const res = await fetch(url, opts);
        if (!res.ok) {
          const error = await res.json();
          throw new Error(error.error || '–û—à–∏–±–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏');
        }
        await fetchUsers();
        showSuccess(successMessage);
      } catch (e) {
        showError(e.message);
      } finally {
        modal.classList.remove('active');
      }
    }

    cancelBtn.addEventListener('click', () => modal.classList.remove('active'));
    confirmBtn.addEventListener('click', applyModeration);

    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const token = localStorage.getItem('token');
        if (!token) throw new Error();
        const usr = await (await fetch('/user-data', { headers: { 'Authorization': `Bearer ${token}` } })).json();
        if (usr.role !== 'admin') throw new Error('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω');
        await fetchUsers();
        setInterval(fetchUsers, 15000);
      } catch {
        window.location.href = '/login.html';
      }
    });

    [searchInput, roleFilter, statusFilter].forEach(el => el.addEventListener('input', applyFilters));
    refreshBtn.addEventListener('click', fetchUsers);
  </script>

  <style>
    .errorMsg {
      color: #ff416c;
      background: rgba(255, 65, 108, 0.1);
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      display: none;
      text-align: center;
    }

    .successMsg {
      color: #00ff88;
      background: rgba(0, 255, 136, 0.1);
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
      display: none;
      text-align: center;
    }

    .user-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 1.5rem;
      transition: transform 0.3s ease;
      cursor: pointer;
      position: relative;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .user-info-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .user-name {
      font-size: 1.2rem;
      color: #fff;
    }

    .user-status {
      font-size: 1rem;
    }

    .status-online::after {
      content: '–û–Ω–ª–∞–π–Ω';
      color: #00ff88;
    }

    .status-offline::after {
      content: '–û—Ñ—Ñ–ª–∞–π–Ω';
      color: #ff416c;
    }

    .user-role-badge {
      display: inline-block;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      margin: 0.5rem 0;
      color: #fff;
    }

    .role-admin {
      background: linear-gradient(135deg, #9c27b0, #ff416c);
    }

    .role-developer {
      background: linear-gradient(135deg, #2196f3, #4caf50);
    }

    .role-user {
      background: linear-gradient(135deg, #ff9800, #ff5722);
    }

    .user-status-info {
      margin: 0.5rem 0;
      font-size: 0.9rem;
    }

    .status-banned {
      color: #ff416c;
      background: rgba(255, 65, 108, 0.2);
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
    }

    .status-suspended {
      color: #ff9800;
      background: rgba(255, 152, 0, 0.2);
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #1a1a2e;
      padding: 2rem;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 0 20px rgba(255, 65, 108, 0.5);
    }

    .input-group {
      margin: 1rem 0;
    }

    .input-group label {
      display: block;
      color: #ff416c;
      margin-bottom: 0.5rem;
    }

    .input-group select {
      width: 100%;
      padding: 0.8rem;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      border: 1px solid #ff416c;
    }

    .admin-buttons {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }
  </style>
</body>
</html>
```